@using AdvantShop.Helpers;
@using AdvantShop.Trial
@using AdvantShop.Saas
@{
    var hash = SettingsGeneral.SiteVersion.GetHashCode();
    var cookieMenu = CommonHelper.GetCookie("adminSidebarMenu");
    var isMobile = SettingsDesign.IsMobileTemplate;

    var metaForMobile = "<meta content=\"width=device-width,initial-scale=1, maximum-scale=1\" name=\"viewport\" viewport-fit=\"cover\" > ";
    var cssClasesForContentColumn = String.Format("content-column--disable-transition {0}", cookieMenu != null && cookieMenu.Value == "true" ? "content-column--offset-compact" : "content-column--offset-default");
}
<!DOCTYPE html>
<html class="@(isMobile ? "mobile-version" : "")"
      data-ng-strict-di
      data-ng-app="app"
      lang="@SettingsMain.Language.Split('-')[0].ToLower()"
      @(new HtmlString("data-ng-controller=\"AppCtrl as app\""))>
<head>
    <meta charset="utf-8">
    <title>@Html.GetPageTitle()</title>
    <base href="@UrlService.GetAdminUrl()"/>
    <meta name="Description" content="@Html.GetPageDescription()"/>
    <meta name="Keywords" content="@Html.GetPageKeywords()"/>
    <meta name="robots" content="noindex,nofollow"/>
    <meta name="generator" content="AdVantShop.NET">
    <meta name="advid" content="@Html.GetAdvId()">
    <link rel="canonical" href="@UrlService.GetCanonicalUrlAdminArea()"/>
    <style>
        .ng-cloak, .x-ng-cloak, .ng-hide:not(.ng-hide-animate) {
            display: none !important;
        }

        form {
            display: block;
        }
    </style>
    <script>
        window.v = '@(hash > 0 ? hash : -hash)';
        console.time('htmlPerf');
    </script>
    @Html.Action("Favicon", "Common", new {area = ""})
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <link rel="dns-prefetch" href="//modules.advantshop.net">

    @*<link rel="subresource" href="../combine/all_admin_new.js">*@

    <link rel="preload" as="font" href="../fonts/OpenSans/OpenSans-SemiBold.woff2" type="font/woff2" crossorigin/>
    <link rel="preload" as="font" href="../fonts/OpenSans/OpenSans-Regular.woff2" type="font/woff2" crossorigin/>
    <link rel="preload" as="font" href="../fonts/OpenSans/OpenSans-Bold.woff2" type="font/woff2" crossorigin/>

    @Html.Partial("~/Areas/Admin/Views/Shared/_HeaderScripts.cshtml")
    @Html.RenderModules("admin_head")
    @(isMobile ? Html.Raw(metaForMobile) : null)
    @if (SaasDataService.IsSaasEnabled)
    {
        @Html.Raw(SaasDataService.CurrentSaasData.AdminPanelExtraHeadBlockData)
    }
</head>
<body class="gray-bg text-floating" @Html.Raw(isMobile ? "data-full-height-mobile" : Html.GetNgController().ToString())>
    @* Конфигурация для маски телефона в админке  *@
    <div data-mask-config="{enablePhoneMask: @SettingsMain.EnablePhoneMask.ToLowerString()}"></div>
    @Html.DisableChromeAutoFill()
    <div id="wrapper">
        @Html.AntiForgeryToken()
        <div id="page-wrapper" class="page-wrapper--new-dasboard">
            @if (!isMobile)
            {
                @Html.Action("TopMenu", "Common", new { area = "adminv3" })
            }

            <div class="wrapper wrapper-content">
                @Html.GetNotifications()
                <div class="container-wrap" content-loader-place>
                    <div class="container-stretch" @Html.Raw(isMobile ? Html.GetNgController() : null)>
                        @if (!isMobile)
                        {
                            @Html.Action("LeftMenu", "Common", new { area = "adminv3" })
                        }
                        <div class="content-column@(!isMobile ? " content-column--disable-transition " + cssClasesForContentColumn : null)"
                             @Html.Raw(!isMobile ? "data-sidebar-menu-state ng-class=\"{'content-column--offset-compact': sidebarMenuState.isCompact, 'content-column--offset-default': !sidebarMenuState.isCompact}\"" : null)>
                            <div class="content-stretch">
                                <div class="content-container ibox">

                                    @if (IsSectionDefined("TopContent"))
                                    {
                                        <div class="ibox">
                                            <div class="ibox-content settings-block b-n">
                                                @if (IsSectionDefined("TopContent"))
                                                {
                                                    @RenderSection("TopContent", false)
                                                }

                                                <div class="balance__padding-page balance__padding-page--m-t-n">
                                                    <div class="balance-block balance-block--content balance-block--content-right">
                                                        <div class="content-page">
                                                            @if (IsSectionDefined("NavMenu"))
                                                            {
                                                                @RenderSection("NavMenu", false)
                                                            }
                                                            else
                                                            {
                                                                @Html.Action("NavMenu", "Common", new { area = "adminv3" })
                                                            }
                                                            <div>
                                                                @RenderBody()
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                    else
                                    {
                                        if (IsSectionDefined("NavMenu"))
                                        {
                                            @RenderSection("NavMenu", false)
                                        }
                                        else if (!isMobile)
                                        {
                                            @Html.Action("NavMenu", "Common", new { area = "adminv3" })
                                        }

                                        @RenderBody()
                                    }
                                </div>
                                @if (!isMobile)
                                {
                                    <div class="footer-container">
                                        @RenderSection("footer", false)
                                        <footer class="site-footer">
                                            <div class="container-fluid">
                                                <div class="row between-xs middle-xs">
                                                    <div class="site-footer__go-to-mobile" data-oc-lazy-load="[{files: [@Html.RenderAssetFilesList("mobileOverlap")]}]">
                                                        <a data-ng-controller="mobileOverlapCtrl as mOverlap" data-ng-click="mOverlap.goToMobile('deviceModeAdmin', 'mobile')" href="javascript:void(0);">Перейти в мобильную версию</a>
                                                    </div>
                                                    <div class="site-footer__version">
                                                        @Html.Partial("~/Areas/Admin/Views/Shared/_Version.cshtml")
                                                    </div>
                                                    <div class="site-footer__links">
                                                        <span class="site-footer__copyright">
                                                            <a href="https://www.advantshop.net?utm_source=advantshop&utm_medium=admin&utm_campaign=footer" target="_blank">AdvantShop</a>
                                                            <span>&copy; @DateTime.Now.Year</span>
                                                        </span>


                                                        <a href="https://vk.com/advantshop" target="_blank" class="site-footer__social-link m-r-sm">
                                                            <svg class="site-footer__social-icon" width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <path d="M16.0218 0C7.15962 0 0 7.15962 0 16.0218C0 24.8404 7.15962 32.0437 16.0218 32.0437C24.884 32.0437 32.0437 24.884 32.0437 16.0218C32 7.15962 24.8404 0 16.0218 0ZM24.1419 17.7244C24.884 18.4666 25.6698 19.1214 26.3683 19.9509C26.6739 20.3001 26.9359 20.693 27.1542 21.0859C27.4598 21.6971 27.1978 22.3083 26.6739 22.352H23.3997C22.5703 22.4393 21.8718 22.09 21.3042 21.5225C20.8677 21.0423 20.4311 20.5621 19.9945 20.0819C19.8199 19.9072 19.6453 19.6889 19.3834 19.558C18.9468 19.2524 18.5539 19.3397 18.292 19.8199C18.03 20.3001 17.9864 20.824 17.9427 21.3479C17.899 22.1337 17.6808 22.3083 16.895 22.352C15.236 22.4393 13.6644 22.1774 12.2237 21.3479C10.9141 20.6057 9.95361 19.558 9.08049 18.3793C7.3779 16.0655 6.06821 13.5771 4.93315 10.9577C4.67121 10.3902 4.84584 10.0409 5.50068 10.0409C6.59209 10.0409 7.63984 10.0409 8.73124 10.0409C9.1678 10.0409 9.4734 10.3029 9.60437 10.6958C10.1719 12.1364 10.8704 13.4898 11.7872 14.7121C12.0055 15.0614 12.2674 15.367 12.6166 15.6289C13.0095 15.8909 13.2715 15.8035 13.4461 15.367C13.5771 15.105 13.6207 14.7995 13.6207 14.5375C13.708 13.5334 13.708 12.573 13.5771 11.5689C13.4898 10.9577 13.1405 10.5648 12.5293 10.4338C12.2237 10.3902 12.2674 10.2592 12.3984 10.0846C12.6603 9.77899 12.9222 9.60437 13.4025 9.60437H17.1132C17.6808 9.73533 17.8117 9.99727 17.899 10.5648V14.6685C17.899 14.8868 18.03 15.5853 18.4229 15.7162C18.7722 15.8035 18.9468 15.5416 19.1651 15.367C20.0382 14.4065 20.693 13.3151 21.2606 12.1801C21.5225 11.6562 21.7408 11.1323 21.9154 10.6085C22.09 10.2156 22.3083 10.0409 22.7449 10.0409H26.3247C26.412 10.0409 26.543 10.0409 26.6303 10.0409C27.2415 10.1282 27.4161 10.3902 27.1978 11.0014C26.8922 11.9181 26.3247 12.704 25.8008 13.4461C25.1896 14.2756 24.5784 15.0614 23.9673 15.8909C23.3997 16.6767 23.4434 17.0696 24.1419 17.7244Z" fill="currentColor" />
                                                            </svg>
                                                        </a>

                                                        <a href="https://www.youtube.com/user/AdVantShop" target="_blank" class="site-footer__social-link m-r-sm">
                                                            <svg class="site-footer__social-icon" width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <path d="M14.0078 18.9971L19.2124 15.9995L14.0078 13.002V18.9971Z" fill="currentColor" />
                                                                <path d="M16 0C7.16479 0 0 7.16479 0 16C0 24.8352 7.16479 32 16 32C24.8352 32 32 24.8352 32 16C32 7.16479 24.8352 0 16 0ZM25.9976 16.0164C25.9976 16.0164 25.9976 19.2612 25.5859 20.8259C25.3552 21.6824 24.6799 22.3577 23.8235 22.5881C22.2588 23 16 23 16 23C16 23 9.75757 23 8.17651 22.5718C7.32007 22.3413 6.64478 21.6658 6.41406 20.8093C6.0022 19.2612 6.0022 16 6.0022 16C6.0022 16 6.0022 12.7554 6.41406 11.1907C6.64453 10.3342 7.33643 9.64233 8.17651 9.41187C9.74121 9 16 9 16 9C16 9 22.2588 9 23.8235 9.42822C24.6799 9.65869 25.3552 10.3342 25.5859 11.1907C26.0142 12.7554 25.9976 16.0164 25.9976 16.0164Z" fill="currentColor" />
                                                            </svg>
                                                        </a>
                                                        <a href="https://t.me/advantshop" target="_blank" class="site-footer__social-link">
                                                            <svg class="site-footer__social-icon" width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <path d="M16 32C24.8387 32 32 24.8387 32 16C32 7.16133 24.8387 0 16 0C7.16133 0 0 7.16133 0 16C0 24.8387 7.16133 32 16 32ZM7.32133 15.6533L22.748 9.70533C23.464 9.44667 24.0893 9.88 23.8573 10.9627L23.8587 10.9613L21.232 23.336C21.0373 24.2133 20.516 24.4267 19.7867 24.0133L15.7867 21.0653L13.8573 22.924C13.644 23.1373 13.464 23.3173 13.0507 23.3173L13.3347 19.2467L20.748 12.5493C21.0707 12.2653 20.676 12.1053 20.2507 12.388L11.0893 18.156L7.14 16.924C6.28267 16.652 6.264 16.0667 7.32133 15.6533V15.6533Z" fill="currentColor" />
                                                            </svg>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </footer>
                                        @Html.GetMiniProfiler()
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                </div>
                @if (isMobile)
                {
                    <div class="container-bottom-fixed"
                         data-set-css-custom-props="{'container-bottom-fixed': 'height'}">
                        @*@Html.Action("LeftMenu", "Common", new { area = "adminv3" })*@
                        @Html.Action("MainMenuMobile", "Common", new { area = "adminv3", numberLimitationMenuItem = 3 })
                        @*<div class="flex middle-xs around-xs white-bg">
                                @Html.Partial("~/Areas/Admin/Views/Common/SaasBlock.cshtml")
                                @if (AdvantShop.Saas.SaasDataService.IsSaasEnabled || TrialService.IsTrialEnabled)
                                {
                                    <a href="service/domains" target="_parent" class="showcase m-l-xs">@T("Admin.Common.TopMenu.DomainBinding")</a>
                                }
                            </div>*@
                    </div>
                }
            </div>
        </div>
    </div>
    @{
        var sb = AdvantShop.CMS.StaticBlockService.GetPagePartByKeyWithCache("admin_footer");
    }
    @Html.Raw(sb != null && sb.Enabled && sb.Content != null ? sb.Content.Replace("@customerId", CustomerContext.CustomerId.ToString()) : "")
    <script>
        console.time('jsPerf');
    </script>
    @if (IsSectionDefined("TrialUserInfo"))
    {@RenderSection("TrialUserInfo", false) }
else
{ @Html.Action("UserInformation", "Home")}
    @Html.Partial("~/Areas/Admin/Views/Shared/_FooterScripts.cshtml")
    @Html.RenderModules("admin_body_end")
    @Html.GetNotifyMessages()
    <sidebar-user-container></sidebar-user-container>
    <partner-info-container></partner-info-container>
    @if (isMobile)
    {
        <!--удаляем input после инициализации--><div>
            <input type="checkbox" id="sidebarState" class="sidebar-state-menu__input" hidden />
            <sidebars-container class="sidebars-container"></sidebars-container>
        </div>
        if (TrialService.IsTrialEnabled)
        {
            <style>
                .container-wrap {
                    padding-bottom: 77px;
                }
            </style>
            <script>
                document.addEventListener('initialize_widget', function (e) {

                    const containerButtons = document.querySelector('chat-24').shadowRoot;
                    const startBtn = containerButtons.querySelector('.startBtn');
                    if (startBtn) {
                        startBtn.style.transform = 'translateY(-72px)';
                    }
                });
            </script>
        }
    }

    @Html.Action("Counter", "Common", new { area = "adminv2" })

    <script>
        function getNg1Hooks(selector, injectorPlease, callback) {
            function tryEl(el) {
                try {
                    if (!injectorPlease && angular.getTestability) {
                        var $$testability = angular.getTestability(el);
                        if ($$testability) {

                            if (callback != null) {
                                callback({ $$testability: $$testability });
                            }

                            return { $$testability: $$testability };
                        }
                    } else {
                        var $injector = angular.element(el).injector();
                        if ($injector) {
                            return { $injector: $injector };
                        }
                    }
                } catch (err) {
                    setTimeout(function () { getNg1Hooks(selector, injectorPlease, callback) }, 100);
                }
            }
            function trySelector(selector) {
                var els = document.querySelectorAll(selector);
                for (var i = 0; i < els.length; i++) {
                    var elHooks = tryEl(els[i]);
                    if (elHooks) {
                        return elHooks;
                    }
                }
            }

            if (selector) {
                return trySelector(selector);
            } else if (window.__TESTABILITY__NG1_APP_ROOT_INJECTOR__) {
                var $injector = window.__TESTABILITY__NG1_APP_ROOT_INJECTOR__;
                var $$testability = null;
                try {
                    $$testability = $injector.get('$$testability');
                } catch (e) { }
                return { $injector: $injector, $$testability: $$testability };
            } else {
                return tryEl(document.body) ||
                    trySelector('[ng-app]') || trySelector('[ng\\:app]') ||
                    trySelector('[ng-controller]') || trySelector('[ng\\:controller]');
            }
        };

        getNg1Hooks('html', undefined, function (hooks) {
            hooks.$$testability.whenStable(function () {
                console.timeEnd('jsPerf');
            });
        })
    </script>
    <script>
        console.timeEnd('htmlPerf');
    </script>
    @if (SaasDataService.IsSaasEnabled && !string.IsNullOrWhiteSpace(SaasDataService.CurrentSaasData.AdminPanelExtraFooterBlockData))
    {
        <div id="admin-panel-extra-footer-block">
            @Html.Raw(SaasDataService.CurrentSaasData.AdminPanelExtraFooterBlockData)
        </div>
    }
</body>
</html>