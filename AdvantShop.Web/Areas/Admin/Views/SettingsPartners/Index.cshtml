@using AdvantShop.Core.Services.Admin
@model AdvantShop.Web.Admin.Models.Settings.Partners.PartnersSettingsModel
@{
    var isMobile = SettingsDesign.IsMobileTemplate;

    if (isMobile)
    {
        Layout = "~/Areas/Admin/Templates/AdminV3/Views/Shared/_Layout.cshtml";
    }
    else
    {
        Layout = "~/Areas/Admin/Views/Partners/_PartnersLayout.cshtml";
    }

    var isAdminv3 = AdminAreaTemplate.Current == "adminv3";


    Html.AddAsset("settingsPartners");
}

@using (Html.BeginAbsoluteUrlForm("Index", "SettingsPartners", FormMethod.Post, new { name = "form", enctype = "multipart/form-data", novalidate = "novalidate" }))
{

    var headerModel = new AdvantShop.Web.Admin.ViewModels.Shared.Common.HeaderViewModel();
    headerModel.DefaultTitle = "Настройки";
    headerModel.ShowOnlySticky = true;

    headerModel.Back = new AdvantShop.Web.Admin.ViewModels.Shared.Common.BackViewModel()
    {
        Text = T("Admin.Settings.IndexSettings").ToString(),
        Url = Url.AbsoluteActionUrl("Index", "PartnersProgramm"),
        NgBackTriggerCallback = "settingsPartners.onSelectTab(null);"
    };

    headerModel.Controls.Add(
        new ButtonModel()
        {
            Modificators = new List<eButtonModificators>()
           {
                eButtonModificators.OnlyIcon
           },
            ColorType = eColorType.Secondary,
            Type = eButtonType.Save,
            Attributes = new[] { "ng-if=\"settingsPartners.tabActiveIndex != null\"", "type=\"submit\"", "data-button-validation disabled", "ng-disabled=\"!form.modified\""},
            Icon = new ButtonIcon()
            {
                SvgName = "done",
                Attributes = new { width = 25, height = 25 }
            }
        }
   );

    @Html.Header(headerModel)

    if (!isMobile)
    {
        <div class="sticky-page-name p-n m-n p-t-xs " sticky sticky-top="0">
            <div class="page-name-block sticky-page-name-inner header-hidden">
                <div class="page-name-block-item-main">
                    <h1 class="page-name-block-text sticky-page-name-text">
                        <span class="float-header-page" ng-bind="app.getTitle()"></span>
                    </h1>
                </div>
                <div class="page-name-block-item-additional">
                    <input type="submit" class="btn btn-sm btn-success" value="@T("Admin.Save")" data-button-validation disabled ng-disabled="!form.modified" />
                </div>
            </div>
        </div>
    }

    @Html.AntiForgeryToken()

    <div class="ibox">
        <uib-tabset active uid="partnerstab" on-select-batch="settingsPartners.onSelectTab(tab.index)"
                    @Html.Raw(isMobile ? "tabs-mode=\"'navigation'\" class=\"tabs-navigation\"" : "")>
            <uib-tab index="'common'" heading="@T("Admin.Settings.Partners.Header")" classes="ng-tab">
                @Html.Partial("_Common", Model)
            </uib-tab>
            <uib-tab index="'reports'" heading="Отчеты" classes="ng-tab">
                @Html.Partial("_Reports", Model)
            </uib-tab>
            @if (!isMobile)
            {
                <div class="js-not-tabs">
                    <input type="submit" class="btn btn-sm btn-success" value="@T("Admin.Save")" data-button-validation disabled ng-disabled="!form.modified" data-e2e="settingsPartnersSave" />
                </div>
            }
        </uib-tabset>
    </div>
}
