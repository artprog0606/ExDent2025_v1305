@model AdvantShop.Web.Admin.Models.Settings.SystemSettingsModel

@{
    var isMobile = SettingsDesign.IsMobileTemplate;
}

<div class="form-group row" is-mobile>
    <div class="col-xs-12 col-md-2">
        <div class="setting-label-wrap setting__label">
            @T("Admin.SettingsSystem.IpBlacklist.SpecifyIP")
        </div>
    </div>
    <div class="col-xs-12 col-md-3">
        <div class="m-b-sm">
            <textarea style="resize: vertical;@(!isMobile ? " vertical-align: top;" : string.Empty)"
                      class="form-control" bs-modifiable
                      ng-model="settingsSystem.ipBlackListSettings.newIpList"
                      rows="2"></textarea>
        </div>
        <button disabled ng-disabled="!settingsSystem.ipBlackListSettings.newIpList || settingsSystem.ipBlackListSettings.newIpList.length == 0" ng-click="settingsSystem.addIpInBlacklist()"
                type="button" class="btn btn-sm btn-action">
            @T("Admin.Add")
        </button>

    </div>
</div>

<div class="form-group row">
    <div class="col-xs-12 col-md-2">
        <div class="setting-label-wrap setting--m-b-none setting__label">
            @T("Admin.SettingsSystem.IpBlacklist.BlockedIPList")
        </div>
    </div>
    <div class="col-xs-12 col-md-3 setting--m-t-sm">
        @if (isMobile)
        {
            <div class="settings-list settings-list--row-gap-3">
                <div ng-repeat="item in settingsSystem.ipBlackList" class="swipe-line m-b-xs">
                    <div class="swipe-line__inner" data-swipe-line>
                        <div class="navigation-item card card--middle swipe-line__content setting__property-group-item"
                             style="padding: 0 16px">
                            <div class="navigation-item__text" data-ng-bind="item">
                            </div>
                        </div>
                        <div data-swipe-line-right class="swipe-line__right swipe-line__btn-group">
                            <button type="button"
                                    class="btn btn-sm btn-danger btn--as-swipe-line flex center-xs middle-xs"
                                    ng-click="settingsSystem.deleteIpFromBlacklist(item)">
                                @T("Admin.Delete")
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div ng-repeat="item in settingsSystem.ipBlackList track by $index">
                <div class="flex payment-row middle-xs between-xs">
                    <div class="col-xs">
                        <span data-ng-bind="item"></span>
                    </div>
                    <a href="" ng-click="settingsSystem.deleteIpFromBlacklist(item)" class="link-invert link-decoration-none fas fa-times"></a>
                </div>
            </div>
        }
        <div ng-if="!settingsSystem.ipBlackList || settingsSystem.ipBlackList.length == 0">
            @T("Admin.SettingsSystem.IpBlacklist.Missing")
        </div>
    </div>
</div>

<div class="row middle-xs form-group">
    <div class="col-xs-12 col-md-2">
        <div class="setting-label-wrap setting--m-b-none setting__label">
            @T("Admin.SettingsSystem.IpBlacklist.CountriesToAllowedSite")
        </div>
    </div>
    <div class="col-xs-12 col-md-6 setting--m-t-sm">

        <div class="m-b-sm ng-cloak" ng-if="settingsSystem.AvailableCountries != null && settingsSystem.AvailableCountries.length != 0">
            <div ng-repeat="item in settingsSystem.AvailableCountries track by $index" class="ng-cloak shipping-location-item @(isMobile ? "m-b-sm" : string.Empty)">
                {{$index != 0 ? ", " : ""}} {{item.Name}} <a href="" ng-click="settingsSystem.deleteAvailableCountry(item.CountryId)" class="link-invert link-decoration-none fas fa-times"></a>
            </div>
        </div>

        <input type="text" bs-modifiable class="form-control input-alt" ng-model="settingsSystem.newAvailableCountry" style="@(!isMobile ? "width: 250px; display: inline-block; vertical-align: top;" : "margin-bottom:10px;")" autocompleter on-type="country" />
        <button type="button" class="btn btn-sm btn-action" ng-disabled="!settingsSystem.newAvailableCountry" ng-click="settingsSystem.addAvailableCountry()">@T("Admin.Add")</button>

    </div>
</div>

<div class="form-group setting__form-group row">
    @if (!isMobile)
    {
        <div class="col-xs-6 col-md-2">
            <div class="setting-label-wrap setting--m-b-none setting__label">
                @Html.LabelFor(x => x.AllowSearchBotsFromOtherCountries, T("Admin.SettingsSystem.AllowSearchBotsFromOtherCountries"))
            </div>
        </div>
    }
    <div class="col-xs-12 col-md-6">
        <label class="adv-checkbox-label">
            @Html.CheckBoxFor(x => x.AllowSearchBotsFromOtherCountries, new { @class = "adv-checkbox-input", ng_init = "settingsSystem.AllowSearchBotsFromOtherCountries=" + Model.AllowSearchBotsFromOtherCountries.ToLowerString(), ng_model = "settingsSystem.AllowSearchBotsFromOtherCountries" })
            <span class="adv-checkbox-emul" data-e2e="AllowSearchBotsFromOtherCountries"></span>
            @if (isMobile)
            {
                <span>@T("Admin.SettingsSystem.AllowSearchBotsFromOtherCountries")</span>
            }
        </label>
    </div>
</div>

<div class="form-group row middle-xs setting__form-group">
    <div class="col-xs-12 col-md-2">
        <div class="setting-label-wrap setting__label">
            @T("Admin.SettingsSystem.IpBlacklist.SortOrder")
        </div>
    </div>
    <div class="col-xs-12 col-md-3">
        <select class="form-control input-alt" bs-modifiable
                ng-model="settingsSystem.trafficSortOrder"
                ng-change="settingsSystem.sortTrafficStatistics()"
                ng-options="item.value as item.text for item in settingsSystem.trafficSortOrders"></select>
    </div>
</div>

<div class="form-group row">
    <div class="col-xs-12 col-md-2">
        <div class="setting-label-wrap setting--m-b-none setting__label">
            <span>
                @T("Admin.SettingsSystem.IpBlacklist.TrafficStatistics")
            </span>
        </div>
    </div>
    <div class="col-xs-12 col-md-3 setting--m-t-sm">
        @if (isMobile)
        {
            <div class="settings-list settings-list--row-gap-3">
                <div ng-repeat="item in settingsSystem.trafficStatistics" class="swipe-line m-b-xs">
                    <div class="swipe-line__inner" data-swipe-line>
                        <div class="navigation-item card card--middle swipe-line__content setting__property-group-item"
                             style="padding: 0 16px"
                             ng-style="item.Banned ? {'background': '#ff00008a'} : {}">
                            <div class="navigation-item__text" data-ng-bind="item.Text">
                            </div>
                        </div>
                        <div data-swipe-line-right class="swipe-line__right swipe-line__btn-group">
                            <button type="button" ng-if="item.Banned && item.ContainsInBannedIpList"
                                    class="btn btn-sm btn-success flex center-xs middle-xs"
                                    ng-click="settingsSystem.deleteIpFromBlacklist(item.Ip)">
                                @T("Admin.SettingsSystem.IpBlacklist.Unban")
                            </button>
                            <button type="button" ng-if="!item.Banned"
                                    class="btn btn-sm btn-danger btn--as-swipe-line flex center-xs middle-xs"
                                    ng-click="settingsSystem.addIpInBlacklist(item.Ip)">
                                @T("Admin.SettingsSystem.IpBlacklist.Ban")
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        }
        else
        {
            <div ng-repeat="item in settingsSystem.trafficStatistics track by $index">
                <div style="{{item.Banned ? 'background: #ff00008a' : ''}}" class="flex payment-row middle-xs between-xs">
                    <div class="col-xs">
                        <span data-ng-bind="item.Text"></span>
                    </div>
                    <a ng-if="item.Banned && item.ContainsInBannedIpList" href="" ng-click="settingsSystem.deleteIpFromBlacklist(item.Ip)" title="@T("Admin.SettingsSystem.IpBlacklist.Unban")" class="link-invert link-decoration-none fas fa-backward"></a>
                    <a ng-if="!item.Banned" href="" ng-click="settingsSystem.addIpInBlacklist(item.Ip)" title="@T("Admin.SettingsSystem.IpBlacklist.Ban")" class="link-invert link-decoration-none fas fa-ban"></a>
                </div>
            </div>
        }
        <div ng-if="!settingsSystem.trafficStatistics || settingsSystem.trafficStatistics.length == 0">
            @T("Admin.SettingsSystem.IpBlacklist.Missing")
        </div>
    </div>
</div>
