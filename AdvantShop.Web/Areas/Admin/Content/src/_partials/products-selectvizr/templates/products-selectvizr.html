<div ng-transclude></div>
<div data-is-mobile ng-class="{'container-fluid': !isMobile.value}">
    <div class="row">
        <div class="col-xs-12 col-md-4" ng-switch="isMobile.value">
            <div ng-switch-when="true" class="m-b">
                Категория:
                <ui-modal-trigger
                    data-controller="'ModalSelectCategoriesCtrl'"
                    data-controller-as="ctrl"
                    data-on-close="$ctrl.onSelectCategory(result)"
                    data-resolve="{treeAjax: {url: $ctrl.selectvizrTreeUrl}, treePlugins: {items: 'search'}, notUnboxingCategory: true, treeShowRoot: true}"
                    template-url="../areas/admin/content/src/_shared/modal/selectCategories/selectCategories.html">
                    <a href="" class="link-dashed" ng-bind="$ctrl.categoryNameSelected || 'Корневая'"></a>
                </ui-modal-trigger>
            </div>
            <div ng-switch-default>
                <div
                    js-tree
                    tree-ajax="{{::$ctrl.selectvizrTreeUrl}}"
                    data-show-root="true"
                    tree-on-init="$ctrl.jstreeOnInit(jstree)"
                    tree-events="select_node:$ctrl.treeCallbacks.select_node;"
                    tree-plugins="search"
                    tree-search="$ctrl.selectvizrTreeSearch"></div>
                <div ng-if="$ctrl.selectvizrGridParams.exportFeedId">
                    <div ng-if="$ctrl.showTextArea">
                        <div class="form-group" ng-class="{'row': isMobile.value,'m-t-sm': !isMobile.value}">
                            Укажите артикулы товаров, которые необходимо исключить<span ng-if="$ctrl.selectvizrGridParams.allowIncludedProducts"
                                >/включить</span
                            >
                            (по одному в строке)
                            <textarea
                                style="resize: vertical"
                                class="form-control"
                                ng-class="{'m-t-sm': !isMobile.value}"
                                ng-model="$ctrl.listArt"
                                rows="7"></textarea>
                        </div>
                        <div class="form-group" ng-class="{'row': isMobile.value}">
                            <a class="btn btn-sm btn-success" ng-click="$ctrl.changeExcludeListProducts(true)" ladda="$ctrl.isProgress">
                                <span ng-bind="$ctrl.selectvizrGridParams.allowIncludedProducts ? 'Исключить из выгрузки' : 'Применить'"></span>
                            </a>
                            <a
                                ng-if="$ctrl.selectvizrGridParams.allowIncludedProducts"
                                class="btn-group m-l-xs btn btn-sm btn-success"
                                ng-click="$ctrl.changeExcludeListProducts(false)"
                                ladda="$ctrl.isProgress">
                                <span>Включить в выгрузку</span>
                            </a>
                        </div>
                    </div>
                    <a
                        ng-if="!$ctrl.showTextArea"
                        ng-click="$ctrl.showTextArea = !$ctrl.showTextArea"
                        ng-class="{'block m-t-sm m-b-sm': !isMobile.value}">
                        Подгрузить списком
                    </a>
                    <!--<div ng-if="!$ctrl.showTextArea" class="form-group" ng-class="{'row': isMobile.value}">
                        <a class="btn btn-sm btn-success" ng-click="$ctrl.changeExcludeListProducts(true)"
                           ladda="$ctrl.isProgress">
                            <span ng-bind="$ctrl.selectvizrGridParams.allowIncludedProducts ? 'Исключить из выгрузки' : 'Применить'"></span>
                        </a>
                        <a ng-if="$ctrl.selectvizrGridParams.allowIncludedProducts"
                           class="btn-group m-l-xs btn btn-sm btn-success"
                           ng-click="$ctrl.changeExcludeListProducts(false)" ladda="$ctrl.isProgress">
                            <span>Включить в выгрузку</span>
                        </a>
                    </div>-->
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-md-8">
            <ui-grid-custom
                grid-unique-id="gridProductsSelectvizr"
                grid-url="$ctrl.selectvizrGridUrl"
                grid-options="$ctrl.selectvizrGridOptions"
                grid-params="$ctrl.selectvizrGridParams"
                grid-on-init="$ctrl.gridOnInit(grid)"
                grid-inplace-url="$ctrl.selectvizrGridInplaceUrl"
                grid-selection-on-change="$ctrl.gridSelectionOnChange(rows)"
                grid-selection-on-init="$ctrl.gridSelectionOnInit(selectionCustom)"
                grid-search-placeholder="'Admin.Js.SearchByNameAndVendorCode'|translate"
                grid-selection-items-selected-fn="$ctrl.gridSelectionItemsSelectedFnWrap(rowEntity)"
                grid-row-identificator="'ProductId'"
                grid-prevent-state-in-hash="true"
                grid-swipe-line="isMobile.value">
                <ui-grid-custom-override-control class="ng-cloak" dynamic-template="$ctrl.customTemplates['uigrid']">
                    <div
                        data-product-grid-item
                        data-row="row"
                        data-grid-scope="grid.appScope"
                        data-renderer-columns="colContainer.renderedColumns"></div>
                </ui-grid-custom-override-control>
            </ui-grid-custom>
        </div>
    </div>
</div>
