<div class="m-t-md" is-mobile>
    <div class="row m-b order-items-summary__row">
        <div class="col-xs order-items-summary__col">
            <div class="text-right order-items-summary__text order-items-summary__text--alt">
                {{'Admin.Js.LeadItemsSummary.Discount' | translate}}
            </div>
        </div>
        <div class="col-xs flex-grow-n order-items-summary-col-value order-items-summary__col">
            <div class="bold">
                <span class="order-items-summary__text" ng-bind="'- ' + $ctrl.Summary.ProductsDiscountPriceStr" data-e2e="LeadDiscount"></span>
                <span
                    ng-if="$ctrl.Summary.Discount != 0"
                    class="order-discount"
                    data-e2e="LeadDiscountPercentAdded"
                    ng-bind="'(' + $ctrl.Summary.Discount + '%)'"></span>
            </div>
            <div ng-if="!$ctrl.readonly">
                <a
                    href=""
                    uib-popover-template="'orderDiscountPopover.html'"
                    popover-trigger="'none'"
                    popover-is-open="$ctrl.discountPopoverIsOpen"
                    popover-class="popover--with-form popover--modalify popover--mobile"
                    ng-click="$ctrl.discountPopoverToggle()"
                    ng-bind="$ctrl.Summary.Discount != 0 || $ctrl.Summary.DiscountValue != 0 ?  ('Admin.Js.LeadItemsSummary.Discount'|translate) : ('Admin.Js.LeadItemsSummary.AddDiscount'|translate)"
                    data-e2e="DiscountAddLink"></a>
                <script type="text/ng-template" id="orderDiscountPopover.html">
                    <form name="orderFormDiscount" is-mobile>
                        <div ng-class="{'modal-header': isMobile.value, 'm-b-xs bold': !isMobile.value}">
                            <div ng-class="{'modal-header-title': isMobile.value}">
                                {{::'Admin.Js.LeadItemsSummary.SpecifyDiscount' | translate}}
                            </div>
                        </div>
                        <div ng-class="{'modal-body': isMobile.value}">
                            <div class="input-group m-b">
                            <span class="input-group-btn" ng-class="{'input-group-btn-discount--left':isMobile.value}">
                                <button type="button" class="btn btn-default" value="0" data-e2e="LeadDiscountNumber"
                                        ng-click="$ctrl.toggleselectCurrencyLabel('0')"
                                        ng-class="{'label-currency-active btn-default--active':$ctrl.selectCurrency === '0'}"><span>{{$ctrl.Summary.LeadCurrency.Symbol}}</span></button>
                                <button type="button" class="btn btn-default" value="1" data-e2e="LeadDiscountPercent"
                                        ng-click="$ctrl.toggleselectCurrencyLabel('1')"
                                        ng-class="{'label-currency-active btn-default--active':$ctrl.selectCurrency === '1'}"><span>%</span></button>
                            </span>
                                <input type="number" value="" class="form-control input-alt" ng-model="$ctrl.DiscountNew"
                                       ng-keyup="$event.keyCode === 13 && $ctrl.changeDiscount($ctrl.DiscountNew)"
                                       data-autofocus="!isMobile.value"/>
                            </div>
                        </div>
                        <div ng-class="{'modal-footer': isMobile.value,'clearfix': !isMobile.value}">
                            <input type="button" value={{'Admin.Js.LeadItemsSummary.Apply'|translate}}
                                   class="btn btn-sm pull-left"
                                   ng-class="{'btn-primary': isMobile.value, 'btn-success': !isMobile.value}"
                                   ng-click="$ctrl.changeDiscount($ctrl.DiscountNew)" data-e2e="LeadDiscountAdd"/>
                            <input type="button" value={{'Admin.Js.AddEdit.Cancel'|translate}}
                                   class="btn btn-sm pull-right" ng-click="$ctrl.discountPopoverClose()"
                                   ng-class="{'btn-default btn-cancel': isMobile.value, 'btn-action': !isMobile.value}"
                                   data-e2e="LeadDiscountCancel"/>
                        </div>
                    </form>
                </script>
            </div>
        </div>
    </div>

    <div class="row m-b order-items-summary__row" ng-if="$ctrl.Summary.LeadItemsCount > 0">
        <div class="col-xs order-items-summary__col">
            <div class="text-right order-items-summary__text order-items-summary__text--alt" ng-if="!$ctrl.readonly">
                <div ng-switch="$ctrl.Summary.City == null || $ctrl.Summary.City.length == 0">
                    <ui-modal-trigger
                        ng-switch-when="true"
                        data-controller="'ModalShippingsCityCtrl'"
                        data-controller-as="ctrl"
                        data-resolve="{ obj: { leadId: $ctrl.leadId }}"
                        data-on-close="$ctrl.chooseAddressResult(result)"
                        template-url="../areas/admin/content/src/lead/modal/shippingsCity/shippingsCity.html">
                        <a href=""> {{::'Admin.Js.LeadItemsSummary.Delivery' | translate}} </a>
                    </ui-modal-trigger>
                    <div ng-switch-when="false">
                        <a href="" ng-click="$ctrl.chooseDelivery()"> {{::'Admin.Js.LeadItemsSummary.Delivery' | translate}} </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xs flex-grow-n order-items-summary-col-value order-items-summary__col bold">
            + <span class="order-items-summary__text" ng-bind="$ctrl.Summary.ShippingCostStr"></span>

            <div
                class="relative inline"
                ng-mouseenter="!isMobile.value ? $ctrl.popoverShippingOpen(): null"
                ng-mouseleave="!isMobile.value ? $ctrl.popoverShippingClose(): null">
                <a
                    class="shippings-actions-toggle"
                    href=""
                    popover-trigger="'outsideClick'"
                    uib-popover-template="'shippingPopover'"
                    popover-class="popover--with-form more-button-popover"
                    popover-is-open="$ctrl.popoverShippingIsOpen"
                    popover-placement="bottom-left">
                    <i class="fa fa-cog"></i>
                </a>

                <script type="text/ng-template" id="shippingPopover">
                    <div class="nav text-nowrap" is-mobile>
                        <ui-modal-trigger size="fixed-530" data-controller="'ModalShippingsTimeCtrl'"
                                          data-controller-as="ctrl"
                                          data-resolve="{ obj: { id: $ctrl.leadId, isLead: true }}"
                                          data-on-close="$ctrl.changeShipping()"
                                          template-url="../areas/admin/content/src/order/modal/shippingsTime/shippingsTime.html"
                                          ng-class="{'more-button-popover__item': isMobile.value}">
                            <a href="" class="block"
                               ng-class="{'m-t-xs m-b-xs fs-xs': !isMobile.value,
                                 'btn btn--simple  btn-link  btn--with-icon btn--horizontal-padding-zero  more-button-popover__btn': isMobile.value}">
                                {{'Admin.Js.LeadItemsSummary.DateTimeDelivery' | translate}}
                            </a>
                        </ui-modal-trigger>
                    </div>
                </script>
            </div>

            <div
                ng-switch="$ctrl.Summary.City == null || $ctrl.Summary.City.length == 0"
                ng-class="{'m-b-xs order-items-summary__text': isMobile.value}">
                <div ng-switch-when="true">
                    {{ $ctrl.Summary.ShippingName.length > 0 ? $ctrl.Summary.ShippingName : ('Admin.Js.LeadItemsSummary.Delivery' | translate)}}
                </div>
                <div ng-switch-when="false">
                    {{ $ctrl.Summary.ShippingName.length > 0 ? $ctrl.Summary.ShippingName : ('Admin.Js.LeadItemsSummary.Delivery' | translate)}}
                </div>
            </div>
            <div class="order-modal-descr m-b-sm" ng-if="$ctrl.Summary.ShippingPickPoint.PickPointAddress.length > 0">
                {{$ctrl.Summary.ShippingPickPoint.PickPointAddress}}
            </div>
            <div
                class="m-b-sm order-items-summary__text"
                ng-if="$ctrl.Summary.DeliveryDate != null || ($ctrl.Summary.DeliveryTime != null && $ctrl.Summary.DeliveryTime.length > 0)">
                <span class="">{{'Admin.Js.OrderItemsSummary.DeliveryDate' | translate}}</span>
                <ui-modal-trigger
                    size="fixed-530"
                    data-controller="'ModalShippingsTimeCtrl'"
                    data-controller-as="ctrl"
                    data-resolve="{ obj: { id: $ctrl.leadId, isLead: true }}"
                    data-on-close="$ctrl.getLeadItemsSummary()"
                    template-url="../areas/admin/content/src/order/modal/shippingsTime/shippingsTime.html">
                    <a href="">
                        <span class="block">{{$ctrl.Summary.DeliveryDate}}</span>
                        <span class="block">{{$ctrl.Summary.DeliveryTime}}</span>
                    </a>
                </ui-modal-trigger>
            </div>
        </div>
    </div>

    <div class="row m-b-md order-items-summary__row">
        <div class="col-xs order-items-summary__col">
            <div class="text-right order-items-summary__summary">{{'Admin.Js.LeadItemsSummary.Summary' | translate}}</div>
        </div>
        <div class="col-xs flex-grow-n order-items-summary-col-value order-items-summary__col bold">
            <span class="order-items-summary__summary" ng-bind="$ctrl.Summary.SumStr" data-e2e="LeadDiscountSummary"></span>
        </div>
    </div>

    <div class="row m-b-md" ng-class="{'bold': !isMobile.value}" ng-if="$ctrl.Summary.LeadItemsCount > 0 && !$ctrl.readonly">
        <div class="col-xs-12">
            <div class="text-right">
                <a href="" ng-click="$ctrl.createOrderWithNotice()">{{'Admin.Js.LeadItemsSummary.CreateOrder' | translate}}</a>
            </div>
        </div>
    </div>
</div>
