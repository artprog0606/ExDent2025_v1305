<div is-mobile class="ng-cloak">
    <div ng-if="!isMobile.value">
        <div class="sortable-row" ng-model="$ctrl.items" as-sortable="$ctrl.sortableOptions">
            <div class="payment-row payment-row--without-pl-zero" ng-repeat="item in $ctrl.items" as-sortable-item>
                <div class="row middle-xs between-xs">
                    <div class="flex middle-xs col-xs">
                        <div class="as-sortable-item-handle" as-sortable-item-handle>
                            <icon-move />
                        </div>
                        <span class="shipping-text col-xs-12">
                            <span class="row">
                                <span class="align-center col-xs-7">
                                    <span class="m-r">
                                        <i class="fa fa-circle" ng-style="{'color': '#' + item.Color || '000'}"></i>
                                    </span>
                                    <ui-modal-trigger
                                        data-controller="'ModalEditProjectStatusCtrl'"
                                        controller-as="ctrl"
                                        template-url="../areas/admin/content/src/taskgroups/projectStatuses/modal/editProjectStatus.html"
                                        data-resolve="{obj: {item: item, statusTypeList: $ctrl.statusTypeList}}"
                                        data-on-close="$ctrl.onEditProjectStatus(item, result)">
                                        <a href="">{{item.Name}}</a>
                                    </ui-modal-trigger>
                                </span>
                                <span class="col-xs-4 pull-right">
                                    <select
                                        ng-model="item.StatusType"
                                        ng-options="s.value as s.label for s in $ctrl.statusTypeList"
                                        ng-change="$ctrl.inplaceStatus(item)"
                                        class="form-control"></select>
                                </span>
                            </span>
                        </span>
                    </div>
                    <div class="flex middle-xs col-fixed-size-ls">
                        <a href="" class="fa fa-times link-invert link-decoration-none" ng-click="$ctrl.deleteItem(item)"></a>
                    </div>
                </div>
            </div>
            <div class="payment-row payment-row--without-pl-zero">
                <div class="row middle-xs between-xs">
                    <div class="shipping-text col-xs">
                        <div class="row">
                            <div class="col-xs">
                                <input type="text" class="form-control" ng-model="$ctrl.newName" />
                            </div>
                            <div class="col-xs-4">
                                <color-picker
                                    ng-model="$ctrl.newColor"
                                    options="$ctrl.colorPickerOptions"
                                    validation-input-text="{{'Admin.Js.TaskStatuses.Color'|translate}}"
                                    api="$ctrl.colorPickerApi"
                                    event-api="$ctrl.colorPickerEventApi">
                                </color-picker>
                            </div>
                            <div class="flex middle-xs col-xs-slim">
                                <a href="" class="btn btn-sm btn-success" ng-click="$ctrl.addItem()">
                                    <span class="fa fa-plus"></span> {{'Admin.Js.AddEdit.Add' | translate}}
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ng-if="isMobile.value" class="swipe-line-container" ng-model="$ctrl.items" as-sortable="$ctrl.sortableOptions">
        <div ng-repeat="item in $ctrl.items" as-sortable-item class="swipe-line">
            <div class="swipe-line__inner" data-swipe-line>
                <div class="navigation-item navigation-item--horizontal card card--middle swipe-line__content card--padding-top-bottom-none">
                    <div as-sortable-item-handle class="as-sortable-item-handle navigation-item__icon">
                        <icon-move>
                            <svg
                                class="icon-move"
                                version="1.0"
                                xmlns="http://www.w3.org/2000/svg"
                                width="10.000000pt"
                                height="20.000000pt"
                                viewBox="0 0 10.000000 20.000000"
                                preserveAspectRatio="xMidYMid meet">
                                <g transform="translate(0.000000,20.000000) scale(0.100000,-0.100000)" fill="#c4c4c4" stroke="none">
                                    <path d="M10 175 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M60 175 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M10 125 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M60 125 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M10 75 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M60 75 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M10 25 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                    <path d="M60 25 c0 -8 7 -15 15 -15 8 0 15 7 15 15 0 8 -7 15 -15 15 -8 0 -15 -7 -15 -15z"></path>
                                </g>
                            </svg>
                        </icon-move>
                    </div>
                    <div class="row middle-xs">
                        <div class="col-xs-6">
                            <ui-modal-trigger
                                data-controller="'ModalEditProjectStatusCtrl'"
                                controller-as="ctrl"
                                template-url="../areas/admin/content/src/taskgroups/projectStatuses/modal/editProjectStatus.html"
                                data-resolve="{obj: {item: item, statusTypeList: $ctrl.statusTypeList}}"
                                data-on-close="$ctrl.onEditProjectStatus(item, result)">
                                <div class="navigation-item__text flex middle-xs" style="padding: 20px 0">
                                    <span class="m-r">
                                        <i class="fa fa-circle" ng-style="{'color': '#' + item.Color || '000'}"></i>
                                    </span>
                                    <span class="fs-md" style="word-break: break-all">{{item.Name}}</span>
                                </div>
                            </ui-modal-trigger>
                        </div>
                        <select
                            ng-model="item.StatusType"
                            ng-options="s.value as s.label for s in $ctrl.statusTypeList"
                            ng-change="$ctrl.inplaceStatus(item)"
                            class="form-control col-xs-6"></select>
                    </div>
                </div>
                <div data-swipe-line-right class="swipe-line__right swipe-line__btn-group">
                    <button
                        class="btn btn-sm btn-danger btn--as-swipe-line flex center-xs middle-xs"
                        ng-click="$ctrl.deleteItem(item)"
                        data-e2e-crm="DealStatusDelete"
                        data-e2e-crm-deal-status-delete-id="{{item.Id}}">
                        Удалить
                    </button>
                </div>
            </div>
        </div>
        <div class="form-group m-t-md">
            <div class="setting-label-wrap setting__label control-label">Добавить статус</div>
            <div class="shipping-text">
                <div class="">
                    <input type="text" class="form-control input-alt" ng-model="$ctrl.newName" data-e2e="DealStatusName" placeholder="Название" />
                </div>
            </div>
            <div class="flex middle-xs m-t-sm">
                <div class="flex-grow m-r-sm setting__leads-color-picker custom-color-picker-wrap--top">
                    <color-picker
                        ng-model="$ctrl.newColor"
                        options="$ctrl.colorPickerOptions"
                        validation-input-text="{{'Admin.Js.TaskStatuses.Color'|translate}}"
                        api="$ctrl.colorPickerApi"
                        event-api="$ctrl.colorPickerEventApi">
                    </color-picker>
                </div>
                <a href="" class="btn btn-sm btn-success" ng-click="$ctrl.addItem()">
                    <span class="fa fa-plus"></span> {{'Admin.Js.AddEdit.Add' | translate}}
                </a>
            </div>
        </div>
    </div>
</div>
<div ng-if="$ctrl.systemItems">
    <div class="m-l-none" ng-class="{'m-sm' : !isMobile.value, 'control-label' : isMobile.value}">
        {{'Admin.Js.TaskGroups.SystemStatuses' | translate}}
    </div>
    <div class="">
        <div class="row" ng-repeat="item in $ctrl.systemItems">
            <div class="col-xs-12">
                <div class="flex payment-row middle-xs between-xs">
                    <div class="flex middle-xs" ng-class="{'col-xs' : !isMobile.value,'flex-grow' : isMobile.value}">
                        <div style="height: 31px"></div>
                        <span class="shipping-text col-xs-10">
                            <span class="m-r">
                                <i class="fa fa-circle" ng-style="{'color': '#' + item.Color || '000'}"></i>
                            </span>
                            <ui-modal-trigger
                                data-controller="'ModalEditProjectStatusCtrl'"
                                controller-as="ctrl"
                                template-url="../areas/admin/content/src/taskgroups/projectStatuses/modal/editProjectStatus.html"
                                data-resolve="{obj: {item: item, statusTypeList: null}}"
                                data-on-close="$ctrl.onEditProjectStatus(item, result, true)">
                                <a href="">{{item.Name}}</a>
                            </ui-modal-trigger>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
