<div class="ng-cloak" ng-if="$ctrl.Grid != null && $ctrl.Grid.length > 0" is-mobile>
    <h3 class="m-b sales-channels-graph__header" ng-if="isMobile.value == false">Продажи</h3>

    <div class="row middle-xs">
        <div class="btn-group col-xs-12 col-md-slim m-b">
            <button
                type="button"
                class="btn btn-sm btn-white"
                ng-class="{'active btn-success': $ctrl.range == 'week'}"
                ng-click="$ctrl.setRange('week')">
                {{'Admin.Js.AnalyticsReport.ByWeeks' | translate}}
            </button>
            <button
                type="button"
                class="btn btn-sm btn-white"
                ng-class="{'active btn-success': $ctrl.range == 'month'}"
                ng-click="$ctrl.setRange('month')">
                {{'Admin.Js.AnalyticsReport.ByMonths' | translate}}
            </button>
            <button
                type="button"
                class="btn btn-sm btn-white"
                ng-class="{'active btn-success': $ctrl.range == 'year'}"
                ng-click="$ctrl.setRange('year')">
                {{'Admin.Js.AnalyticsReport.ByYear' | translate}}
            </button>
        </div>
        <div class="col-xs-12 col-md-slim m-b">
            <div
                class="input-group"
                ng-flatpickr
                fp-opts="{dateFormat: 'd.m.Y', startDateFormat:'Y-m-d', wrap: true, mode: 'range'}"
                fp-on-change="$ctrl.changeDate(selectedDates, dateStr, instance)">
                <span class="flatpickr-custom-wrap flex-grow">
                    <input type="text" class="form-control input-alt" ng-flatpickr-input ng-model="$ctrl.dateRange" />
                </span>
                <span class="input-group-addon" data-toggle><i class="fas fa-calendar-alt"></i></span>
            </div>
        </div>
        <div class="col-xs-12 col-md-slim m-b">
            <select class="form-control input-alt" data-ng-model="$ctrl.group" ng-change="$ctrl.changeGroup($ctrl.group)">
                <option value="day" ng-bind="::'Admin.Js.AnalyticsReport.DetailByDays'|translate" selected></option>
                <option value="week" ng-bind="::'Admin.Js.AnalyticsReport.DetailByWeeks'|translate"></option>
                <option value="month" ng-bind="::'Admin.Js.AnalyticsReport.DetailByMonths'|translate"></option>
            </select>
        </div>
        <div class="col-xs-12 col-md-slim m-b">
            <label class="adv-checkbox-label">
                <input type="checkbox" class="adv-checkbox-input control-checkbox" ng-model="$ctrl.onlyPaid" ng-change="$ctrl.changePaid()" />
                <span class="adv-checkbox-emul"></span>
                <span class="m-l-xs">{{'Admin.Js.AnalyticsReport.OnlyPaid' | translate}}</span>
            </label>
        </div>
    </div>

    <div class="m-b-lg" ng-class="::isMobile.value ? 'card' : null">
        <canvas
            id="salesChannelsGraph"
            class="chart chart-line"
            chart-data="$ctrl.Graph.Data"
            chart-labels="$ctrl.Graph.Labels"
            chart-series="$ctrl.Graph.Series"
            chart-colors="$ctrl.Graph.Colors"
            chart-options="$ctrl.chartOptions"></canvas>
    </div>

    <div>
        <div ng-class="::isMobile.value ? 'card--p-horizontal' : null">
            <div class="row m-b-sm">
                <div class="col-xs bold sales-channels-graph-head-item sales-channels-graph-head-item--first">Канал продаж</div>
                <div class="col-xs-4 col-md-2 bold" ng-class="::isMobile.value ? 'text-right' : 'text-center'">Выручка</div>
                <div class="col-xs-2 bold text-center hidden-xs visible-sm">Прибыль</div>
                <div class="col-xs-2 bold text-center hidden-xs visible-sm">Кол-во заказов</div>
                <div class="col-xs-2 bold text-center hidden-xs visible-sm">Средний чек</div>
                <div class="col-xs-2 bold text-center hidden-xs visible-sm">Продано товаров</div>
            </div>
        </div>
        <div
            ng-repeat="item in $ctrl.Grid track by item.Id"
            ng-class="::isMobile.value ? 'm-b card--p-horizontal card--p-vertical-small' : 'm-b-xs'"
            class="card sales-channels-graph-item">
            <div class="row middle-xs sales-channels-graph-item__row">
                <div class="col-xs">
                    <label class="adv-checkbox-label sales-channels-graph-item__col-inner">
                        <span class="relative line-height">
                            <input
                                type="checkbox"
                                class="adv-checkbox-input control-checkbox"
                                ng-checked="$ctrl.isChecked(item.Id)"
                                ng-click="$ctrl.selectSalesChannel(item.Id)" />
                            <span class="adv-checkbox-emul"></span>
                        </span>
                        <span class="sales-channels-graph-item__name">
                            <span class="sales-channels-graph-item__icon" ng-if="item.Icon != null" ng-bind-html="item.Icon | sanitize"></span>
                            <span>
                                <span ng-bind="item.Name"></span>
                                <span class="hidden-sm sales-channels-graph-item__note">
                                    <ng-pluralize
                                        count="item.OrdersCount"
                                        when="{'0': '{} заказов', '1': '{} заказ', '2' : '{} заказа', '3' : '{} заказа', '4' : '{} заказа', 'other': '{} заказов'}"></ng-pluralize>
                                </span>
                            </span>
                        </span>
                    </label>
                </div>
                <div class="col-xs-4 col-md-2" ng-class="::isMobile.value ? 'text-right' : 'text-center'">
                    <span ng-bind="item.OrdersSum"></span>
                </div>
                <div class="col-xs-2 text-center hidden-xs visible-sm">
                    <span ng-bind="item.Profit"></span>
                </div>
                <div class="col-xs-2 text-center hidden-xs visible-sm">
                    <span ng-bind="item.OrdersCount"></span>
                </div>
                <div class="col-xs-2 text-center hidden-xs visible-sm">
                    <span ng-bind="item.AvgOrderSum"></span>
                </div>
                <div class="col-xs-2 text-center hidden-xs visible-sm">
                    <span ng-bind="item.ProductsCount"></span>
                </div>
            </div>
        </div>
    </div>
</div>
