<div class="ui-grid-filter-block-inner" is-mobile>
    <div class="form-group ui-grid-filter-block__header">
        <div>
            <div class="input-group">
                <input
                    data-e2e="gridFilterSearch"
                    class="form-control input-sm input-alt ui-grid-filter-block__input"
                    type="text"
                    placeholder="{{::$ctrl.gridSearchPlaceholder}}"
                    data-ng-model="$ctrl.gridSearchText"
                    ng-disabled="!$ctrl.gridSearchVisible"
                    ng-keyup="$ctrl.onApplySearch([{name:'search', value: $ctrl.gridSearchText}], null, $event)"
                    autocomplete="off" />
                <input type="password" name="disablingChromeAutoFill" autocomplete="new-password" hidden />

                <div class="btn-group ui-grid-filter-block__btn-container">
                    <button
                        type="button"
                        popover-class="more-button-popover"
                        popover-is-open="$ctrl.sortPopoverIsOpen"
                        uib-popover-template="'sortItems.html'"
                        popover-append-to-body="true"
                        class="btn btn-sm btn--slim btn--icon ui-grid-filter-block__btn--mobile">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path
                                fill="currentColor"
                                d="M8,5.70710678 L8,19.508331 C8,19.7844734 7.77614237,20.008331 7.5,20.008331 C7.22385763,20.008331 7,19.7844734 7,19.508331 L7,5.70710678 L4.85355339,7.85355339 C4.65829124,8.04881554 4.34170876,8.04881554 4.14644661,7.85355339 C3.95118446,7.65829124 3.95118446,7.34170876 4.14644661,7.14644661 L7.14644661,4.14644661 C7.34170876,3.95118446 7.65829124,3.95118446 7.85355339,4.14644661 L10.8535534,7.14644661 C11.0488155,7.34170876 11.0488155,7.65829124 10.8535534,7.85355339 C10.6582912,8.04881554 10.3417088,8.04881554 10.1464466,7.85355339 L8,5.70710678 Z M12.5,6 C12.2238576,6 12,5.77614237 12,5.5 C12,5.22385763 12.2238576,5 12.5,5 L20.5,5 C20.7761424,5 21,5.22385763 21,5.5 C21,5.77614237 20.7761424,6 20.5,6 L12.5,6 Z M12.5,10 C12.2238576,10 12,9.77614237 12,9.5 C12,9.22385763 12.2238576,9 12.5,9 L18.5,9 C18.7761424,9 19,9.22385763 19,9.5 C19,9.77614237 18.7761424,10 18.5,10 L12.5,10 Z M12.5,14 C12.2238576,14 12,13.7761424 12,13.5 C12,13.2238576 12.2238576,13 12.5,13 L16.5,13 C16.7761424,13 17,13.2238576 17,13.5 C17,13.7761424 16.7761424,14 16.5,14 L12.5,14 Z M12.5,18 C12.2238576,18 12,17.7761424 12,17.5 C12,17.2238576 12.2238576,17 12.5,17 L14.5,17 C14.7761424,17 15,17.2238576 15,17.5 C15,17.7761424 14.7761424,18 14.5,18 L12.5,18 Z" />
                        </svg>
                    </button>

                    <button
                        type="button"
                        ng-if="$ctrl.columns.length > 0 && $ctrl.checkVisibleMenuItem($ctrl.columns) != null && $ctrl.checkVisibleMenuItem($ctrl.columns).length > 0"
                        popover-class="more-button-popover"
                        uib-popover-template="'filterItems.html'"
                        popover-append-to-body="true"
                        class="btn btn-sm btn--slim btn--icon ui-grid-filter-block__btn--mobile">
                        <svg width="18" height="18" viewBox="0 0 336 338" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path
                                fill-rule="evenodd"
                                fill="currentColor"
                                clip-rule="evenodd"
                                d="M13.4293 1.42144C1.98825 5.49944 -3.64175 20.3014 2.55725 30.0074C3.51825 31.5124 22.8022 54.0524 45.4112 80.0974C68.0202 106.142 94.4983 136.644 104.253 147.878C114.007 159.113 122.396 169.38 122.896 170.693C123.4 172.021 123.804 197.731 123.804 228.557C123.804 281.883 123.881 284.182 125.785 287.915C128.498 293.233 181.825 335.342 187.928 336.985C195.678 339.072 203.151 336.296 208.438 329.366L211.304 325.609L211.804 248.031C212.235 181.203 212.512 170.166 213.804 168.387C214.629 167.251 241.404 136.268 273.304 99.5355C305.204 62.8035 332.09 31.5165 333.051 30.0105C335.794 25.7115 336.359 18.6954 334.381 13.5164C332.326 8.13344 326.309 2.46443 321.125 1.02443C318.506 0.297434 270.097 -0.024546 167.304 0.00145402C42.3083 0.033454 16.6583 0.270437 13.4293 1.42144ZM314.637 20.8174C314.454 21.2924 288.204 51.6925 256.304 88.3715C219.852 130.285 197.189 157.15 195.304 160.685L192.304 166.308L191.804 241.261L191.304 316.215L167.593 297.564L143.882 278.914L143.593 222.611L143.304 166.307L140.304 160.684C138.419 157.151 115.748 130.275 79.3043 88.3715C47.4043 51.6925 21.1542 21.2924 20.9712 20.8174C20.7842 20.3334 85.4423 19.9524 167.804 19.9524C250.166 19.9524 314.824 20.3334 314.637 20.8174Z" />
                        </svg>
                    </button>
                </div>
                <button
                    type="button"
                    class="ui-grid-filter-block-search-btn btn btn-sm btn-success btn--slim btn--icon"
                    ng-click="$ctrl.onApplySearch([{name:'search', value: $ctrl.gridSearchText}], null, $event)">
                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12.5 11h-.79l-.28-.27A6.471 6.471 0 0013 6.5 6.5 6.5 0 106.5 13c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L17.49 16l-4.99-5zm-6 0C4.01 11 2 8.99 2 6.5S4.01 2 6.5 2 11 4.01 11 6.5 8.99 11 6.5 11z"
                            fill="currentColor" />
                    </svg>
                </button>
            </div>
            <div
                class="input-group-addon ui-grid-custom-filter-total"
                ng-if="$ctrl.hiddenTotalItemsCount !== true && $ctrl.gridOptions.totalItems != null"
                ng-class="{'full-width': !$ctrl.gridSearchVisible}"
                ng-bind="('Admin.Js.UiGridCustomFilter.FoundEntries'|translate) + $ctrl.gridOptions.totalItems"></div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12 col-md-4 col-wl-3" ng-repeat="blockItem in $ctrl.blocks">
            <ui-grid-custom-filter-block
                data-e2e="gridFilterBlock"
                data-e2e-grid-filter-block-name="{{blockItem.name}}"
                class="ibox"
                block-type="blockItem.filter.type"
                item="blockItem"
                on-apply="$ctrl.onApplyBlock(params, item)"
                on-close="$ctrl.onClose(name, item)"></ui-grid-custom-filter-block>
        </div>
    </div>
</div>

<script type="text/ng-template" id="filterItems.html">
    <div class="more-button-popover__item" ng-click="$ctrl.addFilterBlock(item)" ng-repeat="item in $ctrl.checkVisibleMenuItem($ctrl.columns)">{{item.filter.placeholder}}</div>
</script>

<script type="text/ng-template" id="sortItems.html">

    <div ng-repeat="item in $ctrl.checkVisibleMenuItemSort($ctrl.columns)">
        <div class="more-button-popover__item flex middle-xs between-xs"
             ng-class="{'active-item':$ctrl.selectedColumn.name === item.name && sortingDirection === $ctrl.currentSortDirection}"
             ng-repeat="sortingDirection in ['asc', 'desc']">
            <span ng-click="$ctrl.sortByColumn(item, sortingDirection)"
                  class="more-button-popover__item-text">
                {{item.displayName}} ({{sortingDirection === "asc" ? "по возрастанию" : "по убыванию"}})
            </span>
        </div>
    </div>
</script>
